"use strict";var router=require("express").Router(),Contact=require("../models/contact"),contactMessages=[];router.get("/contact/messages",function(e,t){Contact.find({},function(e,t){if(e)throw new Error(e)}).then(function(e){contactMessages=e,t.render("messages",{contactMessages:e})})}),router.get("/contact",function(e,t){t.render("contact")}),router.post("/contact",function(e,t){var o=new Contact;o.email=e.body.emailFromUser,o.message=e.body.emailMessage,o.save(function(e,o){if(e)throw new Error(e);console.log("CONTACT MESSAGE RECEIVED: "+JSON.stringify(o,void 0,2)),t.redirect("/contact")})}),router.post("/contact/readed/:index",function(e,t){Contact.findOneAndUpdate({email:contactMessages[e.params.index].email},{$set:{unreaded:!1,classReaded:"readed"}},{new:!0},function(e,o){if(e)throw new Error(e);console.log("EMAIL NOW IS READED WITH SUCCESS: "+JSON.stringify(o,void 0,2)),t.redirect("/contact/messages")})}),router.post("/contact/remove/:index",function(e,t){Contact.findOneAndRemove({email:contactMessages[e.params.index].email},function(e,o){if(e)throw new Error(e);console.log("EMAIL MESSAGE DELETED WITH SUCCESS: "+JSON.stringify(o,void 0,2)),t.redirect("/contact/messages")})}),module.exports=router;